!function(e){function t(e){if(e&&"FORM"===e.nodeName){var t,i,n=[];for(t=e.elements.length-1;t>=0;t-=1)if(""!==e.elements[t].name)switch(e.elements[t].nodeName){case"INPUT":switch(e.elements[t].type){case"text":case"hidden":case"password":case"button":case"reset":case"submit":n.push(e.elements[t].name+"="+encodeURIComponent(e.elements[t].value));break;case"checkbox":case"radio":e.elements[t].checked&&n.push(e.elements[t].name+"="+encodeURIComponent(e.elements[t].value));break;case"file":}break;case"TEXTAREA":n.push(e.elements[t].name+"="+encodeURIComponent(e.elements[t].value));break;case"SELECT":switch(e.elements[t].type){case"select-one":n.push(e.elements[t].name+"="+encodeURIComponent(e.elements[t].value));break;case"select-multiple":for(i=e.elements[t].options.length-1;i>=0;i-=1)e.elements[t].options[i].selected&&n.push(e.elements[t].name+"="+encodeURIComponent(e.elements[t].options[i].value))}break;case"BUTTON":switch(e.elements[t].type){case"reset":case"submit":case"button":n.push(e.elements[t].name+"="+encodeURIComponent(e.elements[t].value))}}return n.join("&")}}function i(e,t){for(var i in t)e[i]=t[i]}if(!n)var n={};n.Signups||(n.Signups={}),n.Signups.EmbedValidation=function(){this.initialize();var e=this;document.addEventListener?this.form.addEventListener("submit",function(t){e.onFormSubmit(t)}):this.form.attachEvent("onsubmit",function(t){e.onFormSubmit(t)})},i(n.Signups.EmbedValidation.prototype,{initialize:function(){this.form=document.getElementById("mad_mimi_signup_form"),this.submit=document.getElementById("webform_submit_button"),this.callbackName="jsonp_callback_"+Math.round(1e5*Math.random()),this.validEmail=/.+@.+\..+/},onFormSubmit:function(e){e.preventDefault(),this.validate(),this.isValid?this.submitForm():this.revalidateOnChange()},validate:function(){this.isValid=!0,this.emailValidation(),this.fieldAndListValidation(),this.updateFormAfterValidation()},emailValidation:function(){var e=document.getElementById("signup_email");this.validEmail.test(e.value)?this.removeTextFieldError(e):(this.textFieldError(e),this.isValid=!1)},fieldAndListValidation:function(){for(var e=this.form.querySelectorAll(".mimi_field.required"),t=0;t<e.length;++t){var i=e[t],n=this.fieldType(i);"checkboxes"===n||"radio_buttons"===n?this.checkboxAndRadioValidation(i):this.textAndDropdownValidation(i,n)}},fieldType:function(e){var t=e.querySelectorAll(".field_type");return t.length?t[0].getAttribute("data-field-type"):e.className.indexOf("checkgroup")>=0?"checkboxes":"text_field"},checkboxAndRadioValidation:function(e){for(var t=e.getElementsByTagName("input"),i=!1,n=0;n<t.length;++n){var a=t[n];"checkbox"!==a.type&&"radio"!==a.type||!a.checked||(i=!0)}i?$(e).removeClass("invalid"):($(e).addClass("invalid"),this.isValid=!1)},textAndDropdownValidation:function(e,t){for(var i=e.getElementsByTagName("input"),n=0;n<i.length;++n){var a=i[n];a.name.indexOf("signup")>=0&&("text_field"===t?this.textValidation(a):this.dropdownValidation(e,a))}this.htmlEmbedDropdownValidation(e)},textValidation:function(e){"signup_email"!==e.id&&(e.value?this.removeTextFieldError(e):(this.textFieldError(e),this.isValid=!1))},dropdownValidation:function(e,t){t.value?$(e).removeClass("invalid"):($(e).addClass("invalid"),this.onSelectCallback(t),this.isValid=!1)},htmlEmbedDropdownValidation:function(e){for(var t=e.querySelectorAll(".mimi_html_dropdown"),i=this,n=0;n<t.length;++n){var a=t[n];a.value?$(e).removeClass("invalid"):($(e).addClass("invalid"),this.isValid=!1,a.onchange=function(){i.validate()})}},textFieldError:function(e){$(e).addClass("invalid"),e.placeholder=e.getAttribute("data-required-field")},removeTextFieldError:function(e){$(e).removeClass("invalid"),e.placeholder=""},onSelectCallback:function(e){if("undefined"!=typeof Widget&&Widget.BasicDropdown)for(var t=e.parentNode,i=Widget.BasicDropdown.instances,n=this,a=0;a<i.length;++a){var s=i[a];s.wrapperEl===t&&(s.onSelect=function(){n.validate()})}},updateFormAfterValidation:function(){this.form.className=this.setFormClassName(),this.submit.value=this.submitButtonText(),this.submit.disabled=!this.isValid,$(this.submit).addClass(this.isValid?"submit":"disabled")},setFormClassName:function(){var e=this.form.className;return this.isValid?e.replace(/\s?mimi_invalid/,""):-1===e.indexOf("mimi_invalid")?e+=" mimi_invalid":e},submitButtonText:function(){var e,t=document.querySelectorAll(".invalid");return e=this.isValid||!t?this.submit.getAttribute("data-default-text"):t.length||-1===t[0].className.indexOf("checkgroup")?this.submit.getAttribute("data-invalid-text"):this.submit.getAttribute("data-choose-list")},submitForm:function(){this.formSubmitting();var e=this;window[this.callbackName]=function(i){delete window[this.callbackName],document.body.removeChild(t),e.onSubmitCallback(i)};var t=document.createElement("script");t.src=this.formUrl("json"),document.body.appendChild(t)},formUrl:function(e){var i=this.form.action;return"json"===e&&(i+=".json"),i+"?callback="+this.callbackName+"&"+t(this.form)},formSubmitting:function(){$(this.form).addClass("mimi_submitting"),this.submit.value=this.submit.getAttribute("data-submitting-text"),this.submit.disabled=!0,$(this.submit).addClass("disabled")},onSubmitCallback:function(e){e.success&&this.onSubmitSuccess(e.result)},onSubmitSuccess:function(e){this.disableForm(),this.updateSubmitButtonText(this.submit.getAttribute("data-thanks"))},showConfirmationText:function(e){for(var t=this.form.querySelectorAll(".mimi_field"),i=0;i<t.length;++i)t[i].style.display="none";(this.form.querySelectorAll("fieldset")[0]||this.form).innerHTML=e},disableForm:function(){for(var e=this.form.elements,t=0;t<e.length;++t)e[t].disabled=!0},updateSubmitButtonText:function(e){this.submit.value=e},revalidateOnChange:function(){for(var e=this.form.querySelectorAll(".mimi_field.required"),t=this,i=0;i<e.length;++i)for(var n=e[i].getElementsByTagName("input"),a=0;a<n.length;++a)"text_field"===this.fieldType(e[i])?n[a].onkeyup=function(){var e=this;"signup[email]"===e.getAttribute("name")?t.validEmail.test(e.value)&&t.validate():1===e.value.length&&t.validate()}:n[a].onchange=function(){t.validate()}}}),document.addEventListener?document.addEventListener("DOMContentLoaded",function(){new n.Signups.EmbedValidation}):window.attachEvent("onload",function(){new n.Signups.EmbedValidation})}(this);